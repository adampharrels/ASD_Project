<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Room Booking</title>
    <link rel="stylesheet" href="booking.css">
</head>
<body>

    <h1>Book a Room</h1>

    <section id="room-selection">
        <h2>Select a Room</h2>
        <form id="booking-form" method="POST" action="/book-room">
            <label for="room">Room:</label>
            <select id="room" name="room">
                <option value="1.1">Building 1 - Room 1</option>
                <option value="1.2">Building 1 - Room 2</option>
                <option value="1.2">Building 1 - Room 3</option>
                <option value="2.1">Building 2 - Room 1</option>
                <option value="2.1">Building 2 - Room 2</option>
                <option value="2.1">Building 2 - Room 3</option>
                <option value="2.1">Building 2 - Room 4</option>
                <option value="3.4">Building 3 - Room 1</option>
                <option value="3.4">Building 3 - Room 2</option>
                <option value="3.4">Building 3 - Room 3</option>
                <option value="3.4">Building 3 - Room 4</option>
                <option value="3.4">Building 3 - Room 5</option>
            </select>

            <label for="date">Date:</label>
            <input type="date" id="date" name="date" required>

            <label for="time">Start Time:</label>
            <input type="time" id="time" name="time" required>

            <label for="duration">Duration (minutes):</label>
            <input type="number" id="duration" name="duration" min="15" max="240" required>

            <button type="submit">Book Room</button>
        </form>
    </section>

    <section id="my-bookings">
        <h2>My Bookings</h2>
        <ul id="booking-list">
        </ul>
    </section>

    <script>
        (function()) {

            const form = document.getElementById('booking-form');
            const listing = document.getElementById('booking-list');
            function pad(n){ return n.toString().padStart(2, '0'); }
            function computeEndTime(dateStr, startTime, minutes) {
                const start = new Date(dateStr + 'T' + startTime);
                const end = new Date(start.getTime() + minutes * 60000);
                return pad(end.getHours()) + ':' + pad(end.getMinutes());
            }

            form.addEventListener('submit', async function(event)) {
                event.preventDefault();
                const room = document.getElementById('room').value;
                const date = document.getElementById('date').value;
                const time = document.getElementById('time').value;
                const duration = parseInt(document.getElementById('duration').value, 10);
                if (!room || !date || !time || isNaN(duration)) {
                    alert('Please fill in all fields.');
                    return;
                }
                const endTime = computeEndTime(date, time, duration);

                const booking = {
                    timeID: date.now()
                    roomId: parseInt(room.split('.')[1]) || 0,
                    startTime: date + 'T' + time,
                    endTime: date + 'T' + endTime,
                    roomName: room,
                    roomType: "",
                    capacity: 20,
                    speaker: false,
                    whiteboard: false,
                    monitor: false,
                    hdmiCable: false,
                    image: ""
                };

                const li = document.createElement('li');
                li.textContent = `${booking.startTime} -> ${booking.endTime}  Room: ${booking.roomName}`;
                 
            }
        }

</body>
</html>
